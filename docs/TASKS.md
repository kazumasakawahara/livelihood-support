# 生活保護受給者尊厳支援システム タスク一覧

**文書番号**: TASK-LVS-2024-001
**バージョン**: 2.0
**作成日**: 2024年12月28日
**ステータス**: ドラフト

---

## 1. プロジェクト概要

### 1.1 フェーズ構成

| フェーズ | 名称 | 目標 |
|---------|------|------|
| Phase 0 | 準備・計画 | 環境構築、チーム編成 |
| Phase 1 | セキュリティ基盤 | 認証・暗号化・監査の実装 |
| Phase 2 | コア機能 | データ入力・管理機能 |
| Phase 3 | AI機能 | ローカルLLM・匿名化 |
| Phase 4 | 統合・テスト | システム統合・品質保証 |
| Phase 5 | 移行・運用開始 | データ移行・本番稼働 |

### 1.2 マイルストーン

| マイルストーン | 成果物 |
|---------------|--------|
| M1: 基盤完了 | セキュリティ基盤稼働 |
| M2: MVP完了 | 基本機能動作確認 |
| M3: AI統合完了 | ローカルLLM統合完了 |
| M4: テスト完了 | 全テスト合格 |
| M5: 本番稼働 | サービス開始 |

---

## 2. Phase 0: 準備・計画

### 2.1 プロジェクト管理

| ID | タスク | 担当 | 依存 | 成果物 |
|----|--------|------|------|--------|
| P0-001 | プロジェクト計画書作成 | PM | - | プロジェクト計画書 |
| P0-002 | リスク評価・対策立案 | PM | P0-001 | リスク管理表 |
| P0-003 | ステークホルダー特定 | PM | P0-001 | 関係者一覧 |
| P0-004 | コミュニケーション計画 | PM | P0-003 | コミュニケーション計画書 |

### 2.2 環境構築

| ID | タスク | 担当 | 依存 | 成果物 |
|----|--------|------|------|--------|
| P0-010 | 開発環境セットアップ | Infra | - | 開発環境 |
| P0-011 | Gitリポジトリ構成 | Dev | P0-010 | リポジトリ |
| P0-012 | CI/CDパイプライン構築 | DevOps | P0-011 | CI/CD設定 |
| P0-013 | ステージング環境構築 | Infra | P0-010 | ステージング環境 |
| P0-014 | 本番環境設計 | Infra | - | インフラ設計書 |

### 2.3 法務・コンプライアンス

| ID | タスク | 担当 | 依存 | 成果物 |
|----|--------|------|------|--------|
| P0-020 | 個人情報保護法対応確認 | Legal | - | 法的チェックリスト |
| P0-021 | 自治体セキュリティポリシー確認 | Security | - | ポリシー適合性報告 |
| P0-022 | AI利用に関する同意書設計 | Legal | P0-020 | 同意書テンプレート |
| P0-023 | データ保持ポリシー策定 | Legal | P0-020 | データ保持ポリシー |

---

## 3. Phase 1: セキュリティ基盤

### 3.1 認証基盤

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P1-001 | Keycloak導入・設定 | Security | P0-010 | Keycloak環境 | FR-001-01 |
| P1-002 | LDAP/AD連携設定 | Security | P1-001 | LDAP連携 | FR-001-01 |
| P1-003 | MFA設定（TOTP） | Security | P1-001 | MFA機能 | FR-001-02 |
| P1-004 | パスワードポリシー設定 | Security | P1-001 | ポリシー適用 | TECH-4.1.1 |
| P1-005 | セッション管理実装 | Dev | P1-001 | セッション機能 | FR-001-04 |
| P1-006 | ログインブルートフォース対策 | Security | P1-001 | アカウントロック | TECH-4.1.1 |

### 3.2 認可基盤

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P1-010 | RBACモデル設計 | Security | - | RBAC設計書 | FR-001-03 |
| P1-011 | ロール定義実装 | Dev | P1-010 | ロール管理 | SPEC-4.1 |
| P1-012 | 権限チェック共通処理 | Dev | P1-011 | 認可ミドルウェア | TECH-4.1.2 |
| P1-013 | ケース担当者マッピング | Dev | P1-012 | 担当者管理 | FR-001-03 |

### 3.3 暗号化基盤

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P1-020 | HashiCorp Vault導入 | Security | P0-010 | Vault環境 | NFR-001-04 |
| P1-021 | シークレット管理設計 | Security | P1-020 | シークレット設計書 | TECH-4.2 |
| P1-022 | データベース暗号化設定 | Security | P1-020 | 暗号化DB | NFR-001-01 |
| P1-023 | TLS証明書管理 | Security | P1-020 | 証明書管理 | NFR-001-02 |
| P1-024 | Neo4j TLS設定 | Infra | P1-023 | Bolt over TLS | TECH-4.2.2 |

### 3.4 監査基盤

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P1-030 | 監査ログスキーマ設計 | Dev | - | ログスキーマ | FR-006-01 |
| P1-031 | 監査ログ記録共通処理 | Dev | P1-030 | ログ記録機能 | TECH-4.4 |
| P1-032 | ログ改ざん防止（ハッシュチェーン） | Security | P1-031 | 改ざん防止機能 | FR-006-02 |
| P1-033 | ログ検索・エクスポート機能 | Dev | P1-031 | ログ管理UI | FR-006-03 |
| P1-034 | ログローテーション設定 | Infra | P1-031 | ログ管理 | NFR-004-01 |

### 3.5 ネットワークセキュリティ

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P1-040 | リバースプロキシ（Nginx）設定 | Infra | P1-023 | Nginx設定 | TECH-3.1 |
| P1-041 | ファイアウォール設定 | Infra | - | FW設定 | TECH-3.2 |
| P1-042 | ネットワーク分離設計 | Infra | - | ネットワーク設計書 | TECH-3.2 |
| P1-043 | 内部通信TLS化 | Infra | P1-023 | 内部TLS | TECH-4.2.2 |

---

## 4. Phase 2: コア機能

### 4.1 データベース

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P2-001 | Neo4jクラスタ構築 | Infra | P1-024 | Neo4jクラスタ | NFR-002 |
| P2-002 | 7本柱スキーマ実装 | Dev | P2-001 | DBスキーマ | SPEC-3.1 |
| P2-003 | インデックス・制約設定 | Dev | P2-002 | インデックス | TECH-5.2 |
| P2-004 | DB操作共通ライブラリ | Dev | P2-002 | db_operations.py | TECH-5.3 |
| P2-005 | マイグレーション管理 | Dev | P2-002 | マイグレーションツール | - |

### 4.2 API基盤

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P2-010 | FastAPIプロジェクト構築 | Dev | P0-011 | APIプロジェクト | TECH-6 |
| P2-011 | 認証ミドルウェア統合 | Dev | P1-005, P2-010 | 認証統合 | FR-001 |
| P2-012 | エラーハンドリング共通化 | Dev | P2-010 | エラー処理 | TECH-6.3 |
| P2-013 | リクエストバリデーション | Dev | P2-010 | バリデーション | TECH-4.3 |
| P2-014 | レート制限実装 | Dev | P2-010 | レート制限 | - |

### 4.3 クライアント管理

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P2-020 | クライアントCRUD API | Dev | P2-004 | クライアントAPI | FR-002 |
| P2-021 | 同意管理機能 | Dev | P2-020 | 同意管理 | FR-003-03 |
| P2-022 | 担当者割当機能 | Dev | P2-020, P1-013 | 担当者管理 | FR-001-03 |

### 4.4 ケース記録管理

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P2-030 | ケース記録CRUD API | Dev | P2-004 | 記録API | FR-002-01 |
| P2-031 | 論理削除実装 | Dev | P2-030 | 論理削除 | FR-002-02 |
| P2-032 | 変更履歴（バージョン管理） | Dev | P2-030 | バージョン管理 | FR-002-03 |
| P2-033 | ファイル添付機能 | Dev | P2-030 | 添付機能 | FR-002-04 |

### 4.5 二次被害防止機能

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P2-040 | NgApproach管理API | Dev | P2-004 | NgApproach API | FR-004-01 |
| P2-041 | 訪問前警告機能 | Dev | P2-040 | 警告機能 | FR-004-02 |
| P2-042 | 緊急情報取得API | Dev | P2-004 | 緊急情報API | FR-004-04 |

### 4.6 UI実装

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P2-050 | Streamlit認証統合 | Dev | P1-001 | 認証済みUI | SPEC-5.1 |
| P2-051 | ケース記録入力画面 | Dev | P2-030, P2-050 | 入力UI | FR-002 |
| P2-052 | NgApproach登録画面 | Dev | P2-040, P2-050 | NgApproach UI | FR-004-01 |
| P2-053 | クライアント一覧画面 | Dev | P2-020, P2-050 | 一覧UI | - |

---

## 5. Phase 3: AI機能

### 5.1 ローカルLLM基盤

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P3-001 | Ollama環境構築 | Infra | P0-010 | Ollama環境 | TECH-7.1 |
| P3-002 | LLMモデル選定・検証 | AI | P3-001 | モデル評価報告 | TECH-2.1 |
| P3-003 | GPU環境最適化 | Infra | P3-001 | GPU設定 | TECH-7.1 |
| P3-004 | LLMアクセスライブラリ | Dev | P3-001 | LLMクライアント | TECH-7.1 |

### 5.2 匿名化機能

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P3-010 | PII検出ルール設計 | Security | - | PII検出ルール | TECH-8.1 |
| P3-011 | 匿名化エンジン実装 | Dev | P3-010 | 匿名化機能 | FR-003-02 |
| P3-012 | 再識別処理実装 | Dev | P3-011 | 再識別機能 | TECH-8.2 |
| P3-013 | 匿名化精度検証 | QA | P3-011 | 検証報告 | - |

### 5.3 AI構造化機能

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P3-020 | プロンプトテンプレート設計 | AI | - | プロンプト設計書 | TECH-7.2 |
| P3-021 | ケース記録構造化機能 | Dev | P3-004, P3-011 | 構造化機能 | FR-003-01 |
| P3-022 | プロンプトインジェクション対策 | Security | P3-020 | セキュリティ対策 | TECH-7.2 |
| P3-023 | AI生成コンテンツラベリング | Dev | P3-021 | ラベリング機能 | FR-003-04 |
| P3-024 | 構造化精度検証 | QA | P3-021 | 検証報告 | - |

### 5.4 MCP Server

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P3-030 | MCPサーバー基盤 | Dev | P2-010 | MCPサーバー | SPEC-5.1 |
| P3-031 | 認証・認可統合 | Dev | P1-005, P3-030 | MCP認証 | FR-001 |
| P3-032 | 訪問ブリーフィングツール | Dev | P3-030, P2-040 | ブリーフィング | FR-003-05 |
| P3-033 | 類似ケース検索ツール | Dev | P3-030, P2-004 | 類似検索 | FR-003-06 |
| P3-034 | 引き継ぎサマリーツール | Dev | P3-030 | サマリー生成 | FR-005-04 |
| P3-035 | 批判的指導検知ツール | Dev | P3-030, P3-021 | 検知機能 | FR-004-03 |

---

## 6. Phase 4: 統合・テスト

### 6.1 統合テスト

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P4-001 | 統合テスト計画策定 | QA | Phase 2, 3 | テスト計画書 | TECH-9.1 |
| P4-002 | 認証フロー統合テスト | QA | P4-001 | テスト報告 | FR-001 |
| P4-003 | ケース管理フロー統合テスト | QA | P4-001 | テスト報告 | FR-002 |
| P4-004 | AI機能統合テスト | QA | P4-001 | テスト報告 | FR-003 |
| P4-005 | 監査ログ統合テスト | QA | P4-001 | テスト報告 | FR-006 |

### 6.2 セキュリティテスト

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P4-010 | 脆弱性診断（OWASP Top 10） | Security | P4-001 | 診断報告 | TECH-9.2 |
| P4-011 | ペネトレーションテスト | Security | P4-010 | ペンテスト報告 | SPEC-7.2 |
| P4-012 | 認証・認可テスト | Security | P4-001 | テスト報告 | TECH-9.2 |
| P4-013 | データ保護テスト | Security | P4-001 | テスト報告 | TECH-9.2 |
| P4-014 | 脆弱性修正 | Dev | P4-010, P4-011 | 修正完了 | - |

### 6.3 性能テスト

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P4-020 | 負荷テスト（50同時ユーザー） | QA | P4-001 | 負荷テスト報告 | NFR-003-04 |
| P4-021 | 長時間運転テスト（72時間） | QA | P4-020 | 安定性報告 | SPEC-7.3 |
| P4-022 | レスポンスタイム検証 | QA | P4-020 | 性能報告 | NFR-003 |
| P4-023 | 性能チューニング | Dev | P4-022 | 最適化完了 | - |

### 6.4 ユーザー受入テスト

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P4-030 | UATシナリオ作成 | QA | P4-001 | UATシナリオ | SPEC-7.1 |
| P4-031 | UAT実施（CW向け） | QA | P4-030 | UAT報告 | - |
| P4-032 | UAT実施（SV向け） | QA | P4-030 | UAT報告 | - |
| P4-033 | フィードバック対応 | Dev | P4-031, P4-032 | 修正完了 | - |

---

## 7. Phase 5: 移行・運用開始

### 7.1 運用準備

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P5-001 | 運用手順書作成 | Ops | Phase 4 | 運用手順書 | - |
| P5-002 | 障害対応手順書作成 | Ops | P5-001 | 障害対応手順書 | NFR-002-03 |
| P5-003 | バックアップ・リストア手順書 | Ops | P5-001 | バックアップ手順書 | NFR-004 |
| P5-004 | 監視設定・アラート設定 | Ops | P5-001 | 監視設定 | TECH-10.1 |
| P5-005 | 運用チーム教育 | PM | P5-001 | 教育完了 | - |

### 7.2 ユーザー準備

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P5-010 | ユーザーマニュアル作成 | PM | Phase 4 | マニュアル | - |
| P5-011 | ユーザー教育資料作成 | PM | P5-010 | 教育資料 | - |
| P5-012 | ユーザー教育実施 | PM | P5-011 | 教育完了 | - |
| P5-013 | ヘルプデスク準備 | Ops | P5-010 | ヘルプデスク体制 | - |

### 7.3 データ移行

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P5-020 | 移行計画策定 | Dev | Phase 4 | 移行計画書 | - |
| P5-021 | データクレンジング | Dev | P5-020 | クレンジング完了 | - |
| P5-022 | 移行ツール開発 | Dev | P5-020 | 移行ツール | - |
| P5-023 | 移行リハーサル | Dev | P5-022 | リハーサル報告 | - |
| P5-024 | 本番データ移行 | Dev | P5-023 | 移行完了 | - |
| P5-025 | データ検証 | QA | P5-024 | 検証報告 | - |

### 7.4 本番稼働

| ID | タスク | 担当 | 依存 | 成果物 | 仕様参照 |
|----|--------|------|------|--------|----------|
| P5-030 | Go/No-Go判定 | PM | P5-025, P4 | 判定結果 | - |
| P5-031 | 本番環境最終確認 | Ops | P5-030 | 確認報告 | - |
| P5-032 | サービス開始 | Ops | P5-031 | サービス稼働 | - |
| P5-033 | ハイパーケア期間運用 | Ops | P5-032 | ハイパーケア報告 | - |
| P5-034 | 本番運用移行 | Ops | P5-033 | 運用移行完了 | - |

---

## 8. タスク依存関係図

```
Phase 0 (準備)
    │
    ├─→ P0-010 (開発環境) ─→ P0-011 (Git) ─→ P0-012 (CI/CD)
    │
    └─→ P0-020 (法務確認) ─→ P0-022 (同意書)
           │
           ▼
Phase 1 (セキュリティ基盤)
    │
    ├─→ P1-001 (Keycloak) ─→ P1-002 (LDAP) ─→ P1-003 (MFA)
    │         │
    │         └─→ P1-005 (セッション) ────────────────────┐
    │                                                     │
    ├─→ P1-020 (Vault) ─→ P1-022 (DB暗号化)              │
    │         │                                           │
    │         └─→ P1-023 (TLS証明書) ─→ P1-024 (Neo4j TLS)│
    │                                                     │
    └─→ P1-030 (監査ログ設計) ─→ P1-031 (ログ記録) ─→ P1-032 (改ざん防止)
           │                                              │
           ▼                                              │
Phase 2 (コア機能)                                        │
    │                                                     │
    ├─→ P2-001 (Neo4jクラスタ) ─→ P2-002 (スキーマ) ─→ P2-004 (DBライブラリ)
    │                                                     │
    ├─→ P2-010 (FastAPI) ─→ P2-011 (認証統合) ←──────────┘
    │         │
    │         └─→ P2-020 (クライアントAPI) ─→ P2-030 (記録API)
    │                   │
    │                   └─→ P2-040 (NgApproach API)
    │
    └─→ P2-050 (Streamlit認証) ─→ P2-051 (入力UI)
           │
           ▼
Phase 3 (AI機能)
    │
    ├─→ P3-001 (Ollama) ─→ P3-002 (モデル選定) ─→ P3-004 (LLMクライアント)
    │                                                     │
    ├─→ P3-010 (PII検出) ─→ P3-011 (匿名化) ─────────────┤
    │                                                     │
    │                                                     ▼
    └─→ P3-020 (プロンプト設計) ─→ P3-021 (構造化機能) ─→ P3-030 (MCPサーバー)
                                                          │
                                                          ▼
Phase 4 (テスト)                                    P3-032~035 (MCPツール)
    │
    ├─→ P4-001 (統合テスト計画) ─→ P4-002~005 (統合テスト)
    │
    ├─→ P4-010 (脆弱性診断) ─→ P4-011 (ペンテスト) ─→ P4-014 (修正)
    │
    ├─→ P4-020 (負荷テスト) ─→ P4-023 (チューニング)
    │
    └─→ P4-030 (UATシナリオ) ─→ P4-031~032 (UAT実施) ─→ P4-033 (対応)
           │
           ▼
Phase 5 (移行・運用)
    │
    ├─→ P5-001 (運用手順書) ─→ P5-004 (監視設定)
    │
    ├─→ P5-010 (マニュアル) ─→ P5-012 (教育)
    │
    └─→ P5-020 (移行計画) ─→ P5-023 (リハーサル) ─→ P5-024 (本番移行)
                                                          │
                                                          ▼
                                                   P5-030 (Go/No-Go)
                                                          │
                                                          ▼
                                                   P5-032 (サービス開始)
```

---

## 9. リスク管理

### 9.1 主要リスク

| ID | リスク | 影響度 | 発生確率 | 対策 |
|----|--------|--------|----------|------|
| R-001 | ローカルLLM性能不足 | 高 | 中 | 早期PoC、モデル複数検証 |
| R-002 | 匿名化の不完全性 | 高 | 中 | 専門家レビュー、テスト強化 |
| R-003 | セキュリティテスト不合格 | 高 | 低 | 早期セキュリティレビュー |
| R-004 | ユーザー受入れ困難 | 中 | 中 | 早期プロトタイプ、継続的フィードバック |
| R-005 | 法的コンプライアンス問題 | 高 | 低 | Phase 0での法務確認 |

---

## 10. 品質ゲート

### 10.1 Phase完了基準

| Phase | 完了基準 |
|-------|----------|
| Phase 0 | 全タスク完了、環境稼働確認 |
| Phase 1 | 認証・暗号化・監査の動作確認、セキュリティレビュー合格 |
| Phase 2 | 全API動作確認、単体テスト80%カバレッジ |
| Phase 3 | AI機能動作確認、匿名化精度95%以上 |
| Phase 4 | 全テスト合格、脆弱性ゼロ（重大・高） |
| Phase 5 | Go/No-Go合格、サービス正常稼働 |

---

## 11. 改訂履歴

| バージョン | 日付 | 変更内容 | 承認者 |
|-----------|------|----------|--------|
| 1.0 | - | 初版作成 | - |
| 2.0 | 2024-12-28 | セキュリティ強化版 | - |

---

**文書終了**
